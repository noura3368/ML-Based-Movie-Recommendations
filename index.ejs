<!DOCTYPE html>
<style>
    .ms-n5 {
    margin-left: -40px;
    }

    .bottom {
        display: flex;
        justify-content: center;
        align-items: center;
        text-align: center;
        
    }
    .tab {
        tab-size: 10;
    }
    #loader {
    border: 10px solid #f3f3f3;
    border-radius: 50%;
    border-top: 10px solid #3498db;
    width: 90px;
    height: 90px;
    -webkit-animation: spin 2s linear infinite; /* Safari */
    animation: spin 2s linear infinite;
}

/* Safari */
@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

</style>
<html>
    <head>
        <title>Movie Site</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head>
    <body style="background-image: url('https://static-cse.canva.com/blob/559210/filmtitles.jpg');">
        <div id="input_div_id" style="position: absolute;">
                <input type="text" style="margin-top: 300px; margin-left:430px; width:600px; height:auto; display:inline-block;" placeholder="Search.." name="search" id="example-search-input" class="form-control border rounded-pill">
                <button type="submit" id="submit_button" class="btn btn-light" style="width:100px; margin-left:10px">Submit</button>
                <br><br>
        </div>
        <div class="modal" tabindex="-1" role="dialog" id="MyModal">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Error!</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <p>We can't find the requested movie in our database! Please try a different movie.</p>
                </div>
              </div>
            </div>
        </div>
    </body>
    <!--- 
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
          <div class="navbar-header ms-auto">
            <a class="navbar-brand" href="#">WebSiteName</a>
          </div>
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#">Page 1</a></li>
            <li><a href="#">Page 2</a></li>
            <li><a href="#">Page 3</a></li>
          </ul>
        </div>
      </nav>
        
      <div class="container">
        <h3>Inverted Navbar</h3>
        <p>An inverted navbar is black instead of gray.</p>
      </div>
      --->
      
    <script>
    
    $( "#example-search-input" ).on( "click", function() {
        this.value = "";
    });
    $("#submit_button").on("click", function() {
       
        var val = document.getElementById("example-search-input").value
        $("#input_div_id").animate({top: '-250px'});
        if(document.getElementById("loader")){
            var img = document.getElementsByTagName("img")
            var list_of_img = []
            for(i = 1; i < img.length + 1; i++){
                c = document.getElementById(i);
                list_of_img[i - 1] = c
            }
            
            for(k=0; k < list_of_img.length; k++){
                list_of_img[k].parentNode.removeChild(list_of_img[k])
            }
            
            $("#loader").fadeIn("slow")
        }
        else {
            const loader = document.createElement("div")
            loader.id = "loader"
            loader.style.marginLeft = "700px"
            loader.style.marginTop = "200px"
            document.getElementById("input_div_id").appendChild(loader);
        }
        $.ajax({
            type: "POST",
            url: "/",
            data: {movie: val},
            success: function(response){
                $("#loader").fadeOut("slow")
                loader.style.display = "none"
                console.log(response.movies.length)
                console.log(response.movies)
                if(response.movies.includes("False")){
                    $('#MyModal').delay(800).fadeIn('slow');
                    setTimeout(function() {
                        $("#MyModal").modal('show');
                        }, 1500);
                   
                }
                else {
                    var movies_dictionary = (response.movies).replace(/':/g,"\":").replace(/, '/g, ", \"").replace(/{'/g, "{\"").replace(/'}/, 
                    "\"}").replace(/',/g, "\",").replace(/'https/g, "\"https")
                    movies_dictionary = JSON.parse(movies_dictionary)
                    var counter = 1
                    for(let key in movies_dictionary){
                        const pic = document.createElement('img');
                        pic.src = movies_dictionary[key]
                        pic.style.height = '300px'
                        pic.style.width = 'auto'
                        pic.style.margin = '25px 50px 75px 100px'
                        pic.id = counter
                        pic.style.display = "none"
                        document.getElementById("input_div_id").appendChild(pic);
                        $("#" + counter).fadeIn("slow");
                        counter += 1 
                    }
                }
            }
        });
    });
    </script>
    </body>
</html>